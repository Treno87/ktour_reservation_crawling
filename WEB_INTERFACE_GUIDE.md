# KTour 크롤러 웹 인터페이스 사용 가이드

## 목차
1. [시작하기](#시작하기)
2. [인터페이스 기능](#인터페이스-기능)
3. [사용 방법](#사용-방법)
4. [FAQ](#faq)

---

## 시작하기

### 1. 필수 패키지 설치

웹 인터페이스를 사용하기 위해 추가 패키지를 설치합니다.

```bash
pip install -r requirements.txt
```

새로 추가된 패키지:
- Flask 3.0.0 (웹 프레임워크)
- Flask-CORS 4.0.0 (CORS 지원)

### 2. 웹 서버 실행

```bash
python web_app.py
```

**출력 예시:**
```
============================================================
KTour 예약 크롤러 웹 인터페이스
============================================================

브라우저에서 http://localhost:5000 접속하세요

 * Running on http://0.0.0.0:5000
```

### 3. 브라우저 접속

브라우저를 열고 다음 주소로 접속:
- **로컬**: http://localhost:5000
- **네트워크**: http://[서버IP]:5000

---

## 인터페이스 기능

### 메인 화면 구성

```
┌─────────────────────────────────────────────────────┐
│          🔍 KTour 예약 크롤러                        │
│    예약 현황을 자동으로 수집하고 분석하세요          │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ 크롤링 설정                                          │
├─────────────────────────────────────────────────────┤
│ 상호명:      [마리엠헤어                    ]       │
│                                                      │
│ 시작 날짜:   [2025-12-05]  종료 날짜: [2025-12-31] │
│                                                      │
│ 크롤링 주기: ◉ 일단위  ○ 주단위  ○ 월단위         │
│                                                      │
│ 출력 형식:   [CSV ▼]                                │
│                                                      │
│ [크롤링 시작]  [오늘 날짜로 빠른 시작]              │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ 크롤링 진행 상황                                     │
├─────────────────────────────────────────────────────┤
│ ████████████░░░░░░░░░░ 60%                          │
│ 15 / 25 (60%)                                       │
│                                                      │
│ 현재 날짜: 2025-12-15                               │
│ 상태: 2025-12-15 크롤링 중...                       │
│                                                      │
│ [✅ 크롤링 완료!]                                   │
│ 완료! 47건 수집                                     │
│ [결과 파일 다운로드]                                │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ 저장된 파일 목록                     [새로고침]     │
├─────────────────────────────────────────────────────┤
│ reservations_마리엠헤어_20251205.csv               │
│ 125.43 KB · 2025-12-05 14:32:10      [다운로드]    │
│                                                      │
│ reservations_마리엠헤어_20251204.xlsx              │
│ 98.21 KB · 2025-12-04 09:15:22       [다운로드]    │
└─────────────────────────────────────────────────────┘
```

### 주요 기능

#### 1. **상호명 입력**
- 크롤링할 상호명 입력
- 기본값: "마리엠헤어"
- 여러 상호를 크롤링하려면 각각 실행

#### 2. **날짜 범위 선택**
- **시작 날짜**: 크롤링 시작 날짜
- **종료 날짜**: 크롤링 종료 날짜
- 날짜 피커를 통해 쉽게 선택 가능

#### 3. **크롤링 주기**
- **일단위**: 매일 크롤링 (2025-12-05, 2025-12-06, 2025-12-07...)
- **주단위**: 매주 크롤링 (2025-12-05, 2025-12-12, 2025-12-19...)
- **월단위**: 매월 크롤링 (2025-12-05, 2026-01-05, 2026-02-05...)

#### 4. **출력 형식**
- **CSV**: 엑셀에서 열기 좋음
- **Excel (XLSX)**: 서식이 적용된 엑셀 파일
- **JSON**: API 연동이나 프로그래밍 처리용

#### 5. **실시간 진행 상황**
- 진행률 바: 시각적으로 진행 상태 확인
- 현재 처리 중인 날짜 표시
- 상태 메시지: 무엇을 하고 있는지 표시

#### 6. **결과 다운로드**
- 크롤링 완료 시 즉시 다운로드 가능
- 파일 목록에서 과거 결과도 다운로드 가능

---

## 사용 방법

### Case 1: 오늘 하루 예약 현황 빠르게 확인

**단계:**
1. 웹 인터페이스 접속
2. **[오늘 날짜로 빠른 시작]** 버튼 클릭
3. 진행 상황 확인
4. 완료 후 결과 다운로드

**예상 소요 시간**: 15-30초

---

### Case 2: 한 달치 예약 현황 수집 (일단위)

**단계:**
1. **상호명**: 마리엠헤어 (또는 원하는 상호)
2. **시작 날짜**: 2025-12-01
3. **종료 날짜**: 2025-12-31
4. **크롤링 주기**: **일단위** 선택
5. **출력 형식**: CSV (또는 Excel)
6. **[크롤링 시작]** 클릭
7. 진행 상황 모니터링 (약 10-15분 소요)
8. 완료 후 다운로드

**예상 크롤링 횟수**: 31회 (매일)
**예상 소요 시간**: 10-15분

---

### Case 3: 분기별 예약 현황 수집 (월단위)

**단계:**
1. **시작 날짜**: 2025-01-01
2. **종료 날짜**: 2025-03-31
3. **크롤링 주기**: **월단위** 선택
4. **출력 형식**: Excel
5. **[크롤링 시작]** 클릭

**예상 크롤링 횟수**: 3회 (1월, 2월, 3월)
**예상 소요 시간**: 1-2분

---

### Case 4: 매주 월요일 예약 현황 수집 (주단위)

**단계:**
1. **시작 날짜**: 2025-12-01 (월요일)
2. **종료 날짜**: 2025-12-31
3. **크롤링 주기**: **주단위** 선택
4. **[크롤링 시작]** 클릭

**예상 크롤링 횟수**: 5회 (매주 월요일)
**예상 소요 시간**: 2-3분

---

## 크롤링 주기별 비교

### 예시: 2025년 1월 한 달 (1/1 ~ 1/31)

| 주기 | 크롤링 횟수 | 크롤링 날짜 예시 | 소요 시간 | 추천 용도 |
|------|------------|------------------|-----------|----------|
| **일단위** | 31회 | 1/1, 1/2, 1/3... | 10-15분 | 상세한 일별 분석 |
| **주단위** | 5회 | 1/1, 1/8, 1/15, 1/22, 1/29 | 2-3분 | 주간 트렌드 분석 |
| **월단위** | 1회 | 1/1 | 30초 | 월별 스냅샷 |

---

## 출력 형식별 특징

### CSV
**장점:**
- 가볍고 빠름
- 엑셀에서 바로 열기 가능
- 다양한 도구에서 사용 가능

**추천 상황:**
- 데이터 분석
- 엑셀 피벗 테이블 작성
- 일반적인 용도

**파일명 예시:**
```
reservations_마리엠헤어_2025-12-01_to_2025-12-31_20251205_143210.csv
```

---

### Excel (XLSX)
**장점:**
- 서식 적용
- 열 너비 자동 조정
- 전문적인 보고서

**추천 상황:**
- 리포트 작성
- 발표 자료
- 아카이브

**파일명 예시:**
```
reservations_마리엠헤어_2025-12-01_to_2025-12-31_20251205_143210.xlsx
```

---

### JSON
**장점:**
- 프로그래밍 처리 용이
- API 연동
- 구조화된 데이터

**추천 상황:**
- 다른 시스템과 연동
- 자동화 스크립트
- 데이터베이스 임포트

**파일명 예시:**
```
reservations_마리엠헤어_2025-12-01_to_2025-12-31_20251205_143210.json
```

---

## 실시간 모니터링

### 진행 상황 확인

크롤링이 진행되는 동안 다음 정보가 실시간으로 업데이트됩니다:

1. **진행률 바**
   ```
   ████████████░░░░░░░░░░ 60%
   ```

2. **처리 건수**
   ```
   15 / 25 (60%)
   ```

3. **현재 날짜**
   ```
   현재 날짜: 2025-12-15
   ```

4. **상태 메시지**
   ```
   상태: 2025-12-15 크롤링 중...
   ```

### 상태 메시지 종류

| 메시지 | 의미 |
|--------|------|
| "크롤러 초기화 중..." | 크롤러 객체 생성 중 |
| "WebDriver 설정 중..." | 브라우저 드라이버 준비 중 |
| "로그인 중..." | 사이트 로그인 시도 중 |
| "2025-12-05 크롤링 중..." | 해당 날짜 데이터 수집 중 |
| "데이터 저장 중..." | 수집한 데이터를 파일로 저장 중 |
| "완료! 47건 수집" | 크롤링 성공 완료 |
| "수집된 데이터가 없습니다" | 해당 날짜에 예약 없음 |
| "오류 발생: ..." | 에러 발생 (로그 확인 필요) |

---

## 파일 관리

### 저장 위치
모든 파일은 `output/` 디렉토리에 저장됩니다.

### 파일명 규칙
```
reservations_[상호명]_[시작날짜]_to_[종료날짜]_[타임스탬프].[확장자]
```

**예시:**
```
reservations_마리엠헤어_2025-12-01_to_2025-12-31_20251205_143210.csv
```

### 파일 목록 새로고침
- 자동: 크롤링 완료 시
- 수동: [새로고침] 버튼 클릭

### 파일 다운로드
1. 파일 목록에서 원하는 파일 찾기
2. [다운로드] 버튼 클릭
3. 브라우저 다운로드 폴더에 저장

---

## 팁 & 모범 사례

### 1. 크롤링 주기 선택 가이드

**일단위 사용 시기:**
- 일별 예약 변화 추적
- 상세한 트렌드 분석
- 재고 관리

**주단위 사용 시기:**
- 주간 리포트 작성
- 중장기 트렌드 파악
- 빠른 스냅샷

**월단위 사용 시기:**
- 분기/연간 보고서
- 장기 트렌드 분석
- 빠른 개요 확인

### 2. 성능 최적화

**빠른 크롤링을 위해:**
- 필요한 날짜만 선택
- 주단위/월단위 활용
- 헤드리스 모드 (백그라운드 자동 적용)

### 3. 데이터 관리

**정기적으로:**
- 오래된 파일 백업
- 불필요한 파일 삭제
- 디스크 공간 확인

---

## FAQ

### Q1: 크롤링 중에 다른 작업을 할 수 있나요?

**A:** 예, 가능합니다. 크롤링은 백그라운드에서 실행되므로 브라우저 탭을 닫아도 계속 진행됩니다. 다만 웹 서버(`web_app.py`)는 계속 실행 중이어야 합니다.

---

### Q2: 크롤링이 실패하면 어떻게 하나요?

**A:**
1. 상태 메시지에서 오류 확인
2. `crawler.log` 파일에서 상세 로그 확인
3. 로그인 정보가 올바른지 확인
4. 인터넷 연결 확인
5. 다시 시도

---

### Q3: 여러 상호를 동시에 크롤링할 수 있나요?

**A:** 현재 버전에서는 한 번에 하나의 상호만 크롤링 가능합니다. 여러 상호를 크롤링하려면 각각 순차적으로 실행해야 합니다.

**해결 방법:**
- 첫 번째 상호 크롤링 완료 후
- 상호명 변경
- 다시 크롤링 시작

---

### Q4: 크롤링 중 멈춘 것 같아요

**A:**
1. 진행률 바가 움직이는지 확인
2. 상태 메시지가 업데이트되는지 확인 (1초마다)
3. 5분 이상 변화 없으면:
   - 브라우저 새로고침
   - `web_app.py` 재시작
   - 다시 시도

---

### Q5: 결과 파일을 못 찾겠어요

**A:**
1. **파일 목록** 섹션에서 확인
2. `output/` 디렉토리 직접 확인
3. 파일명 검색:
   ```bash
   ls output/ | grep reservations
   ```

---

### Q6: 모바일에서도 사용 가능한가요?

**A:** 예, 반응형 디자인으로 모바일 브라우저에서도 사용 가능합니다. 단, 크롤링 시간이 길 경우 화면이 꺼지지 않도록 주의하세요.

---

### Q7: 외부 네트워크에서 접속하려면?

**A:**
1. 서버의 IP 주소 확인
   ```bash
   ipconfig  # Windows
   ifconfig  # Linux/Mac
   ```

2. 방화벽에서 5000 포트 열기

3. 브라우저에서 접속:
   ```
   http://[서버IP]:5000
   ```

**보안 주의:**
- 공용 네트워크에서는 비권장
- 필요시 인증 추가 구현 권장

---

### Q8: 크롤링을 자동으로 예약 실행할 수 있나요?

**A:** 웹 인터페이스는 수동 실행용입니다. 자동 예약 실행은 다음 방법 사용:

**방법 1: Cron (Linux/Mac)**
```bash
# 매일 오전 9시 실행
0 9 * * * python /path/to/main.py --headless --date $(date +\%Y-\%m-\%d)
```

**방법 2: 작업 스케줄러 (Windows)**
- 작업 스케줄러 열기
- 새 작업 만들기
- `python main.py` 실행 설정

---

## 트러블슈팅

### 문제 1: 웹 서버가 시작되지 않아요

**원인:**
- 5000 포트가 이미 사용 중
- Flask 미설치

**해결:**
```bash
# Flask 설치
pip install flask flask-cors

# 다른 포트 사용
# web_app.py 마지막 줄 수정:
app.run(debug=True, host='0.0.0.0', port=8080)
```

---

### 문제 2: "크롤링이 진행 중입니다" 오류

**원인:**
- 이전 크롤링이 완료되지 않음
- 백그라운드 프로세스 남음

**해결:**
```bash
# web_app.py 재시작
# Ctrl+C로 종료 후 다시 실행
python web_app.py
```

---

### 문제 3: 다운로드 버튼을 눌러도 파일이 안 받아져요

**원인:**
- 파일 경로 문제
- 권한 문제

**해결:**
1. `output/` 디렉토리 직접 확인
2. 파일이 있으면 직접 복사
3. 브라우저 콘솔에서 오류 확인 (F12)

---

## 고급 기능 (향후 개발)

### 계획된 기능
- [ ] 다중 상호 동시 크롤링
- [ ] 사용자 인증 및 권한 관리
- [ ] 크롤링 스케줄 예약
- [ ] 이메일 알림
- [ ] 대시보드 및 통계 차트
- [ ] 데이터 비교 및 분석 도구

---

## 기술 지원

### 로그 확인
```bash
# 웹 서버 로그
# 터미널에서 실시간 확인 가능

# 크롤러 로그
tail -f crawler.log
```

### 버그 리포트
- GitHub Issues
- 이메일: support@example.com

---

**최종 업데이트**: 2025-12-05
**버전**: 1.0.0
